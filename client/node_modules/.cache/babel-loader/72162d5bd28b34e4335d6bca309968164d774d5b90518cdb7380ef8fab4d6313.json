{"ast":null,"code":"Object.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar graphql_1 = require(\"graphql\");\nvar deprecated_decorator_1 = require(\"deprecated-decorator\");\nvar _1 = require(\".\");\n// takes a GraphQL-JS schema and an object of connectors, then attaches\n// the connectors to the context by wrapping each query or mutation resolve\n// function with a function that attaches connectors if they don't exist.\n// attaches connectors only once to make sure they are singletons\nvar attachConnectorsToContext = deprecated_decorator_1.deprecated({\n  version: '0.7.0',\n  url: 'https://github.com/apollostack/graphql-tools/issues/140'\n}, function (schema, connectors) {\n  if (!schema || !(schema instanceof graphql_1.GraphQLSchema)) {\n    throw new Error('schema must be an instance of GraphQLSchema. ' + 'This error could be caused by installing more than one version of GraphQL-JS');\n  }\n  if (typeof connectors !== 'object') {\n    var connectorType = typeof connectors;\n    throw new Error(\"Expected connectors to be of type object, got \" + connectorType);\n  }\n  if (Object.keys(connectors).length === 0) {\n    throw new Error('Expected connectors to not be an empty object');\n  }\n  if (Array.isArray(connectors)) {\n    throw new Error('Expected connectors to be of type object, got Array');\n  }\n  if (schema['_apolloConnectorsAttached']) {\n    throw new Error('Connectors already attached to context, cannot attach more than once');\n  }\n  schema['_apolloConnectorsAttached'] = true;\n  var attachconnectorFn = function (root, args, ctx) {\n    if (typeof ctx !== 'object') {\n      // if in any way possible, we should throw an error when the attachconnectors\n      // function is called, not when a query is executed.\n      var contextType = typeof ctx;\n      throw new Error(\"Cannot attach connector because context is not an object: \" + contextType);\n    }\n    if (typeof ctx.connectors === 'undefined') {\n      ctx.connectors = {};\n    }\n    Object.keys(connectors).forEach(function (connectorName) {\n      var connector = connectors[connectorName];\n      if (!!connector.prototype) {\n        ctx.connectors[connectorName] = new connector(ctx);\n      } else {\n        throw new Error(\"Connector must be a function or an class\");\n      }\n    });\n    return root;\n  };\n  _1.addSchemaLevelResolveFunction(schema, attachconnectorFn);\n});\nexports.default = attachConnectorsToContext;","map":{"version":3,"names":["graphql_1","require","deprecated_decorator_1","_1","attachConnectorsToContext","deprecated","version","url","schema","connectors","GraphQLSchema","Error","connectorType","Object","keys","length","Array","isArray","attachconnectorFn","root","args","ctx","contextType","forEach","connectorName","connector","prototype","addSchemaLevelResolveFunction","exports","default"],"sources":["../../src/generate/attachConnectorsToContext.ts"],"sourcesContent":[null],"mappings":";;;AAAA,IAAAA,SAAA,GAAAC,OAAA;AAEA,IAAAC,sBAAA,GAAAD,OAAA;AAIA,IAAAE,EAAA,GAAAF,OAAA;AAEA;AACA;AACA;AACA;AACA,IAAMG,yBAAyB,GAAGF,sBAAA,CAAAG,UAAU,CAC1C;EACEC,OAAO,EAAE,OAAO;EAChBC,GAAG,EAAE;CACN,EACD,UAASC,MAAqB,EAAEC,UAAuB;EACrD,IAAI,CAACD,MAAM,IAAI,EAAEA,MAAM,YAAYR,SAAA,CAAAU,aAAa,CAAC,EAAE;IACjD,MAAM,IAAIC,KAAK,CACb,+CAA+C,GAC7C,8EAA8E,CACjF;;EAGH,IAAI,OAAOF,UAAU,KAAK,QAAQ,EAAE;IAClC,IAAMG,aAAa,GAAG,OAAOH,UAAU;IACvC,MAAM,IAAIE,KAAK,CACb,mDAAiDC,aAAe,CACjE;;EAEH,IAAIC,MAAM,CAACC,IAAI,CAACL,UAAU,CAAC,CAACM,MAAM,KAAK,CAAC,EAAE;IACxC,MAAM,IAAIJ,KAAK,CAAC,+CAA+C,CAAC;;EAElE,IAAIK,KAAK,CAACC,OAAO,CAACR,UAAU,CAAC,EAAE;IAC7B,MAAM,IAAIE,KAAK,CAAC,qDAAqD,CAAC;;EAExE,IAAIH,MAAM,CAAC,2BAA2B,CAAC,EAAE;IACvC,MAAM,IAAIG,KAAK,CACb,sEAAsE,CACvE;;EAEHH,MAAM,CAAC,2BAA2B,CAAC,GAAG,IAAI;EAC1C,IAAMU,iBAAiB,GAAmC,SAAAA,CACxDC,IAAS,EACTC,IAA4B,EAC5BC,GAAQ;IAER,IAAI,OAAOA,GAAG,KAAK,QAAQ,EAAE;MAC3B;MACA;MACA,IAAMC,WAAW,GAAG,OAAOD,GAAG;MAC9B,MAAM,IAAIV,KAAK,CACb,+DAA6DW,WAAa,CAC3E;;IAEH,IAAI,OAAOD,GAAG,CAACZ,UAAU,KAAK,WAAW,EAAE;MACzCY,GAAG,CAACZ,UAAU,GAAG,EAAE;;IAErBI,MAAM,CAACC,IAAI,CAACL,UAAU,CAAC,CAACc,OAAO,CAAC,UAAAC,aAAa;MAC3C,IAAIC,SAAS,GAAehB,UAAU,CAACe,aAAa,CAAC;MACrD,IAAI,CAAC,CAACC,SAAS,CAACC,SAAS,EAAE;QACzBL,GAAG,CAACZ,UAAU,CAACe,aAAa,CAAC,GAAG,IAAoBC,SAAU,CAACJ,GAAG,CAAC;OACpE,MAAM;QACL,MAAM,IAAIV,KAAK,CAAC,0CAA0C,CAAC;;IAE/D,CAAC,CAAC;IACF,OAAOQ,IAAI;EACb,CAAC;EACDhB,EAAA,CAAAwB,6BAA6B,CAACnB,MAAM,EAAEU,iBAAiB,CAAC;AAC1D,CAAC,CACF;AAEDU,OAAA,CAAAC,OAAA,GAAezB,yBAAyB"},"metadata":{},"sourceType":"script","externalDependencies":[]}