{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar graphql_1 = require(\"graphql\");\nvar isSpecifiedScalarType_1 = require(\"../isSpecifiedScalarType\");\nvar visitSchema_1 = require(\"../transforms/visitSchema\");\nvar RenameTypes = /** @class */function () {\n  function RenameTypes(renamer, options) {\n    this.renamer = renamer;\n    this.reverseMap = {};\n    var _a = options || {},\n      _b = _a.renameBuiltins,\n      renameBuiltins = _b === void 0 ? false : _b,\n      _c = _a.renameScalars,\n      renameScalars = _c === void 0 ? true : _c;\n    this.renameBuiltins = renameBuiltins;\n    this.renameScalars = renameScalars;\n  }\n  RenameTypes.prototype.transformSchema = function (originalSchema) {\n    var _a;\n    var _this = this;\n    return visitSchema_1.visitSchema(originalSchema, (_a = {}, _a[visitSchema_1.VisitSchemaKind.TYPE] = function (type) {\n      if (isSpecifiedScalarType_1.default(type) && !_this.renameBuiltins) {\n        return undefined;\n      }\n      if (type instanceof graphql_1.GraphQLScalarType && !_this.renameScalars) {\n        return undefined;\n      }\n      var newName = _this.renamer(type.name);\n      if (newName && newName !== type.name) {\n        _this.reverseMap[newName] = type.name;\n        var newType = Object.assign(Object.create(type), type);\n        newType.name = newName;\n        return newType;\n      }\n    }, _a[visitSchema_1.VisitSchemaKind.ROOT_OBJECT] = function (type) {\n      return undefined;\n    }, _a));\n  };\n  RenameTypes.prototype.transformRequest = function (originalRequest) {\n    var _a;\n    var _this = this;\n    var newDocument = graphql_1.visit(originalRequest.document, (_a = {}, _a[graphql_1.Kind.NAMED_TYPE] = function (node) {\n      var name = node.name.value;\n      if (name in _this.reverseMap) {\n        return __assign(__assign({}, node), {\n          name: {\n            kind: graphql_1.Kind.NAME,\n            value: _this.reverseMap[name]\n          }\n        });\n      }\n    }, _a));\n    return {\n      document: newDocument,\n      variables: originalRequest.variables\n    };\n  };\n  RenameTypes.prototype.transformResult = function (result) {\n    if (result.data) {\n      var data = this.renameTypes(result.data, 'data');\n      if (data !== result.data) {\n        return __assign(__assign({}, result), {\n          data: data\n        });\n      }\n    }\n    return result;\n  };\n  RenameTypes.prototype.renameTypes = function (value, name) {\n    var _this = this;\n    if (name === '__typename') {\n      return this.renamer(value);\n    }\n    if (value && typeof value === 'object') {\n      var newValue_1 = Array.isArray(value) ? []\n      // Create a new object with the same prototype.\n      : Object.create(Object.getPrototypeOf(value));\n      var returnNewValue_1 = false;\n      Object.keys(value).forEach(function (key) {\n        var oldChild = value[key];\n        var newChild = _this.renameTypes(oldChild, key);\n        newValue_1[key] = newChild;\n        if (newChild !== oldChild) {\n          returnNewValue_1 = true;\n        }\n      });\n      if (returnNewValue_1) {\n        return newValue_1;\n      }\n    }\n    return value;\n  };\n  return RenameTypes;\n}();\nexports.default = RenameTypes;","map":{"version":3,"names":["graphql_1","require","isSpecifiedScalarType_1","visitSchema_1","RenameTypes","renamer","options","reverseMap","_a","_b","renameBuiltins","_c","renameScalars","prototype","transformSchema","originalSchema","_this","visitSchema","VisitSchemaKind","TYPE","type","default","undefined","GraphQLScalarType","newName","name","newType","Object","assign","create","ROOT_OBJECT","transformRequest","originalRequest","newDocument","visit","document","Kind","NAMED_TYPE","node","value","__assign","kind","NAME","variables","transformResult","result","data","renameTypes","newValue_1","Array","isArray","getPrototypeOf","returnNewValue_1","keys","forEach","key","oldChild","newChild"],"sources":["../../src/transforms/RenameTypes.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}