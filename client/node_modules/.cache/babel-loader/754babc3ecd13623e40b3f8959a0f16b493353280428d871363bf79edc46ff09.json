{"ast":null,"code":"Object.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar graphql_1 = require(\"graphql\");\n/*\n * fn: The function to decorate with the logger\n * logger: an object instance of type Logger\n * hint: an optional hint to add to the error's message\n */\nfunction decorateWithLogger(fn, logger, hint) {\n  if (typeof fn === 'undefined') {\n    fn = graphql_1.defaultFieldResolver;\n  }\n  var logError = function (e) {\n    // TODO: clone the error properly\n    var newE = new Error();\n    newE.stack = e.stack;\n    /* istanbul ignore else: always get the hint from addErrorLoggingToSchema */\n    if (hint) {\n      newE['originalMessage'] = e.message;\n      newE['message'] = \"Error in resolver \" + hint + \"\\n\" + e.message;\n    }\n    logger.log(newE);\n  };\n  return function (root, args, ctx, info) {\n    try {\n      var result = fn(root, args, ctx, info);\n      // If the resolve function returns a Promise log any Promise rejects.\n      if (result && typeof result.then === 'function' && typeof result.catch === 'function') {\n        result.catch(function (reason) {\n          // make sure that it's an error we're logging.\n          var error = reason instanceof Error ? reason : new Error(reason);\n          logError(error);\n          // We don't want to leave an unhandled exception so pass on error.\n          return reason;\n        });\n      }\n      return result;\n    } catch (e) {\n      logError(e);\n      // we want to pass on the error, just in case.\n      throw e;\n    }\n  };\n}\nexports.default = decorateWithLogger;","map":{"version":3,"names":["graphql_1","require","decorateWithLogger","fn","logger","hint","defaultFieldResolver","logError","e","newE","Error","stack","message","log","root","args","ctx","info","result","then","catch","reason","error","exports","default"],"sources":["../../src/generate/decorateWithLogger.ts"],"sourcesContent":[null],"mappings":";;;AAAA,IAAAA,SAAA,GAAAC,OAAA;AAGA;;;;;AAKA,SAASC,kBAAkBA,CACzBC,EAA8C,EAC9CC,MAAe,EACfC,IAAY;EAEZ,IAAI,OAAOF,EAAE,KAAK,WAAW,EAAE;IAC7BA,EAAE,GAAGH,SAAA,CAAAM,oBAAoB;;EAG3B,IAAMC,QAAQ,GAAG,SAAAA,CAACC,CAAQ;IACxB;IACA,IAAMC,IAAI,GAAG,IAAIC,KAAK,EAAE;IACxBD,IAAI,CAACE,KAAK,GAAGH,CAAC,CAACG,KAAK;IACpB;IACA,IAAIN,IAAI,EAAE;MACRI,IAAI,CAAC,iBAAiB,CAAC,GAAGD,CAAC,CAACI,OAAO;MACnCH,IAAI,CAAC,SAAS,CAAC,GAAG,uBAAqBJ,IAAI,UAAKG,CAAC,CAACI,OAAS;;IAE7DR,MAAM,CAACS,GAAG,CAACJ,IAAI,CAAC;EAClB,CAAC;EAED,OAAO,UAACK,IAAI,EAAEC,IAAI,EAAEC,GAAG,EAAEC,IAAI;IAC3B,IAAI;MACF,IAAMC,MAAM,GAAGf,EAAE,CAACW,IAAI,EAAEC,IAAI,EAAEC,GAAG,EAAEC,IAAI,CAAC;MACxC;MACA,IACEC,MAAM,IACN,OAAOA,MAAM,CAACC,IAAI,KAAK,UAAU,IACjC,OAAOD,MAAM,CAACE,KAAK,KAAK,UAAU,EAClC;QACAF,MAAM,CAACE,KAAK,CAAC,UAACC,MAAsB;UAClC;UACA,IAAMC,KAAK,GAAGD,MAAM,YAAYX,KAAK,GAAGW,MAAM,GAAG,IAAIX,KAAK,CAACW,MAAM,CAAC;UAClEd,QAAQ,CAACe,KAAK,CAAC;UAEf;UACA,OAAOD,MAAM;QACf,CAAC,CAAC;;MAEJ,OAAOH,MAAM;KACd,CAAC,OAAOV,CAAC,EAAE;MACVD,QAAQ,CAACC,CAAC,CAAC;MACX;MACA,MAAMA,CAAC;;EAEX,CAAC;AACH;AAEAe,OAAA,CAAAC,OAAA,GAAetB,kBAAkB"},"metadata":{},"sourceType":"script","externalDependencies":[]}